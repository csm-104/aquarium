C51 COMPILER V9.54   MAIN                                                                  05/02/2023 15:26:32 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\Keil5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main.l
                    -st) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <REGX52.H>
   2          #include "LCD1602.h"
   3          #include "DS1302.h"
   4          #include "Key.h"
   5          #include "Timer0.h"
   6          #include "Water_Level.h"
   7          #include "DS18B20.h"
   8          #include "Delay.h"
   9          
  10          unsigned char KeyNum,MODE,TimeSetSelect,FeedTimeSelect1,FeedTimeSelect2,LedOpenTime,LedCloseTime,TimeSetFl
             -ashFlag,FeedFlag,LightFlag,Days;
  11          char FeedTime1[]={13,00,10};//ç¬¬ä¸€æ¬¡å–‚é£Ÿé¢„å®šæ—¶é—´
  12          char FeedTime2[]={14,00,10};//ç¬¬äºŒæ¬¡å–‚é£Ÿé¢„å®šæ—¶é—´
  13          char LedOpenSet[]={7,00,00};//è¡¥å…‰ç¯æ‰“å¼€é¢„å®šæ—¶é—´
  14          char LedCloseSet[]={19,00,00};//è¡¥å…‰ç¯å…³é—­é¢„å®šæ—¶é—´
  15          
  16          void TimeShow(void)//æ—¶é—´æ˜¾ç¤ºåŠŸèƒ½
  17          {
  18   1              
  19   1              DS1302_ReadTime();//è¯»å–æ—¶é—´
  20   1              LCD_ShowNum(1,1,DS1302_Time[0],2);//æ˜¾ç¤ºå¹´
  21   1              LCD_ShowNum(1,4,DS1302_Time[1],2);//æ˜¾ç¤ºæœˆ
  22   1              LCD_ShowNum(1,7,DS1302_Time[2],2);//æ˜¾ç¤ºæ—¥
  23   1              LCD_ShowNum(2,1,DS1302_Time[3],2);//æ˜¾ç¤ºæ—¶
  24   1              LCD_ShowNum(2,4,DS1302_Time[4],2);//æ˜¾ç¤ºåˆ†
  25   1              LCD_ShowNum(2,7,DS1302_Time[5],2);//æ˜¾ç¤ºç§’
  26   1              LCD_ShowNum(1,16,DS1302_Time[6],1);//æ˜¾ç¤ºæ˜ŸæœŸ
  27   1          LCD_ShowString(1,11,"Days:");
  28   1              LCD_ShowString(2,10,"T:");
  29   1      }
  30          
  31          void TimeSet(void)//æ—¶é—´è®¾ç½®åŠŸèƒ½
  32          {
  33   1              if(KeyNum==2)//æŒ‰é”®2æŒ‰ä¸‹
  34   1              {
  35   2                      TimeSetSelect++;//è®¾ç½®é€‰æ‹©ä½åŠ 1
  36   2                      TimeSetSelect%=17;//è¶Šç•Œæ¸…é›¶
  37   2              }
  38   1              if(KeyNum==3)//æŒ‰é”®3æŒ‰ä¸‹
  39   1              {
  40   2                      TimeSetSelect--;//è®¾ç½®é€‰æ‹©ä½åŠ 1
  41   2                      if(TimeSetSelect==255)
  42   2                      {
  43   3                              TimeSetSelect=16;//è¶Šç•Œæ¸…é›¶ 
  44   3                      }
  45   2              }
  46   1              if(KeyNum==4)//æŒ‰é”®4æŒ‰ä¸‹
  47   1              {
  48   2                      if(TimeSetSelect<7)
  49   2                      {       
  50   3                              DS1302_Time[TimeSetSelect]++;//æ—¶é—´è®¾ç½®ä½æ•°å€¼åŠ 1
  51   3                              if(DS1302_Time[0]>99){DS1302_Time[0]=0;}//å¹´è¶Šç•Œåˆ¤æ–­
  52   3                              if(DS1302_Time[1]>12){DS1302_Time[1]=1;}//æœˆè¶Šç•Œåˆ¤æ–­
  53   3                              if( DS1302_Time[1]==1 || DS1302_Time[1]==3 || DS1302_Time[1]==5 || DS1302_Time[1]==7 || 
C51 COMPILER V9.54   MAIN                                                                  05/02/2023 15:26:32 PAGE 2   

  54   3                                      DS1302_Time[1]==8 || DS1302_Time[1]==10 || DS1302_Time[1]==12)//æ—¥è¶Šç•Œåˆ¤æ–­
  55   3                              {
  56   4                                      if(DS1302_Time[2]>31){DS1302_Time[2]=1;}//å¤§æœˆ
  57   4                              }
  58   3                              else if(DS1302_Time[1]==4 || DS1302_Time[1]==6 || DS1302_Time[1]==9 || DS1302_Time[1]==11)
  59   3                              {
  60   4                                      if(DS1302_Time[2]>30){DS1302_Time[2]=1;}//å°æœˆ
  61   4                              }
  62   3                              else if(DS1302_Time[1]==2)
  63   3                              {
  64   4                                      if(DS1302_Time[0]%4==0)
  65   4                                      {
  66   5                                              if(DS1302_Time[2]>29){DS1302_Time[2]=1;}//é—°å¹´2æœˆ
  67   5                                      }
  68   4                                      else
  69   4                                      {
  70   5                                              if(DS1302_Time[2]>28){DS1302_Time[2]=1;}//å¹³å¹´2æœˆ
  71   5                                      }
  72   4                              }
  73   3                              if(DS1302_Time[3]>23){DS1302_Time[3]=0;}//æ—¶è¶Šç•Œåˆ¤æ–­
  74   3                              if(DS1302_Time[4]>59){DS1302_Time[4]=0;}//åˆ†è¶Šç•Œåˆ¤æ–­
  75   3                              if(DS1302_Time[5]>59){DS1302_Time[5]=0;}//ç§’è¶Šç•Œåˆ¤æ–­
  76   3                              if(DS1302_Time[6]>7){DS1302_Time[6]=0;}//æ˜ŸæœŸè¶Šç•Œåˆ¤æ–­
  77   3                      }
  78   2                      else if(TimeSetSelect>6&&TimeSetSelect<10)
  79   2                      {
  80   3                              FeedTimeSelect1=TimeSetSelect-7;
  81   3                              FeedTime1[FeedTimeSelect1]++;
  82   3                              if(FeedTime1[0]>23){FeedTime1[0]=0;}//æ—¶è¶Šç•Œåˆ¤æ–­
  83   3                          if(FeedTime1[1]>59){FeedTime1[1]=0;}//åˆ†è¶Šç•Œåˆ¤æ–­
  84   3                          if(FeedTime1[2]>59){FeedTime1[2]=0;}//ç§’è¶Šç•Œåˆ¤æ–­               
  85   3                      }
  86   2                      else if(TimeSetSelect>9&&TimeSetSelect<13)
  87   2                      {
  88   3                              FeedTimeSelect2=TimeSetSelect-10;
  89   3                              FeedTime2[FeedTimeSelect2]++;
  90   3                              if(FeedTime2[0]>23){FeedTime2[0]=0;}//æ—¶è¶Šç•Œåˆ¤æ–­
  91   3                          if(FeedTime2[1]>59){FeedTime2[1]=0;}//åˆ†è¶Šç•Œåˆ¤æ–­
  92   3                          if(FeedTime2[2]>59){FeedTime2[2]=0;}//ç§’è¶Šç•Œåˆ¤æ–­               
  93   3                      }
  94   2                      else if(TimeSetSelect>12&&TimeSetSelect<15)
  95   2                      {
  96   3                              LedOpenTime=TimeSetSelect-13;
  97   3                              LedOpenSet[LedOpenTime]++;
  98   3                              if(LedOpenSet[0]>23){LedOpenSet[0]=0;}//æ—¶è¶Šç•Œåˆ¤æ–­
  99   3                          if(LedOpenSet[1]>59){LedOpenSet[1]=0;}//åˆ†è¶Šç•Œåˆ¤æ–­
 100   3      //                  if(LedOpenSet[2]>59){LedOpenSet[2]=0;}//ç§’è¶Šç•Œåˆ¤æ–­             
 101   3                      }
 102   2                      else if(TimeSetSelect>14&&TimeSetSelect<17)
 103   2                      {
 104   3                              LedCloseTime=TimeSetSelect-15;
 105   3                              LedCloseSet[LedCloseTime]++;
 106   3                              if(LedCloseSet[0]>23){LedCloseSet[0]=0;}//æ—¶è¶Šç•Œåˆ¤æ–­
 107   3                          if(LedCloseSet[1]>59){LedCloseSet[1]=0;}//åˆ†è¶Šç•Œåˆ¤æ–­
 108   3      //                  if(LedCloseSet[2]>59){LedCloseSet[2]=0;}//ç§’è¶Šç•Œåˆ¤æ–­           
 109   3                      }
 110   2              }
 111   1              if(KeyNum==5)//æŒ‰é”®5æŒ‰ä¸‹
 112   1              {
 113   2                      if(TimeSetSelect<7)
 114   2                      {       
 115   3                              DS1302_Time[TimeSetSelect]--;//æ—¶é—´è®¾ç½®ä½æ•°å€¼å‡1
C51 COMPILER V9.54   MAIN                                                                  05/02/2023 15:26:32 PAGE 3   

 116   3                              if(DS1302_Time[0]<0){DS1302_Time[0]=99;}//å¹´è¶Šç•Œåˆ¤æ–­
 117   3                              if(DS1302_Time[1]<1){DS1302_Time[1]=12;}//æœˆè¶Šç•Œåˆ¤æ–­
 118   3                              if( DS1302_Time[1]==1 || DS1302_Time[1]==3 || DS1302_Time[1]==5 || DS1302_Time[1]==7 || 
 119   3                                      DS1302_Time[1]==8 || DS1302_Time[1]==10 || DS1302_Time[1]==12)//æ—¥è¶Šç•Œåˆ¤æ–­
 120   3                              {
 121   4                                      if(DS1302_Time[2]<1){DS1302_Time[2]=31;}//å¤§æœˆ
 122   4                                      if(DS1302_Time[2]>31){DS1302_Time[2]=1;}
 123   4                              }
 124   3                              else if(DS1302_Time[1]==4 || DS1302_Time[1]==6 || DS1302_Time[1]==9 || DS1302_Time[1]==11)
 125   3                              {
 126   4                                      if(DS1302_Time[2]<1){DS1302_Time[2]=30;}//å°æœˆ
 127   4                                      if(DS1302_Time[2]>30){DS1302_Time[2]=1;}
 128   4                              }
 129   3                              else if(DS1302_Time[1]==2)
 130   3                              {
 131   4                                      if(DS1302_Time[0]%4==0)
 132   4                                      {
 133   5                                              if(DS1302_Time[2]<1){DS1302_Time[2]=29;}//é—°å¹´2æœˆ
 134   5                                              if(DS1302_Time[2]>29){DS1302_Time[2]=1;}
 135   5                                      }
 136   4                                      else
 137   4                                      {
 138   5                                              if(DS1302_Time[2]<1){DS1302_Time[2]=28;}//å¹³å¹´2æœˆ
 139   5                                              if(DS1302_Time[2]>28){DS1302_Time[2]=1;}
 140   5                                      }
 141   4                              }
 142   3                              if(DS1302_Time[3]<0){DS1302_Time[3]=23;}//æ—¶è¶Šç•Œåˆ¤æ–­
 143   3                              if(DS1302_Time[4]<0){DS1302_Time[4]=59;}//åˆ†è¶Šç•Œåˆ¤æ–­
 144   3                              if(DS1302_Time[5]<0){DS1302_Time[5]=59;}//ç§’è¶Šç•Œåˆ¤æ–­
 145   3                              if(DS1302_Time[6]<0){DS1302_Time[6]=7;}//æ˜ŸæœŸè¶Šç•Œåˆ¤æ–­
 146   3                      }
 147   2                      else if(TimeSetSelect>6&&TimeSetSelect<10)
 148   2                      {
 149   3                              FeedTimeSelect1=TimeSetSelect-7;
 150   3                              FeedTime1[FeedTimeSelect1]--;
 151   3                              if(FeedTime1[0]<0){FeedTime1[0]=23;}//æ—¶è¶Šç•Œåˆ¤æ–­
 152   3                          if(FeedTime1[1]<0){FeedTime1[1]=59;}//åˆ†è¶Šç•Œåˆ¤æ–­
 153   3                  if(FeedTime1[2]<0){FeedTime1[2]=59;}//ç§’è¶Šç•Œåˆ¤æ–­               
 154   3                      }
 155   2                      else if(TimeSetSelect>9&&TimeSetSelect<13)
 156   2                      {
 157   3                              FeedTimeSelect2=TimeSetSelect-10;
 158   3                              FeedTime2[FeedTimeSelect2]--;
 159   3                              if(FeedTime2[0]<0){FeedTime2[0]=23;}//æ—¶è¶Šç•Œåˆ¤æ–­
 160   3                          if(FeedTime2[1]<0){FeedTime2[1]=59;}//åˆ†è¶Šç•Œåˆ¤æ–­
 161   3                  if(FeedTime2[2]<0){FeedTime2[2]=59;}//ç§’è¶Šç•Œåˆ¤æ–­               
 162   3                      }
 163   2                      else if(TimeSetSelect>12&&TimeSetSelect<15)
 164   2                      {
 165   3                              LedOpenTime=TimeSetSelect-13;
 166   3                              LedOpenSet[LedOpenTime]--;
 167   3                              if(LedOpenSet[0]<0){LedOpenSet[0]=23;}//æ—¶è¶Šç•Œåˆ¤æ–­
 168   3                          if(LedOpenSet[1]<0){LedOpenSet[1]=59;}//åˆ†è¶Šç•Œåˆ¤æ–­
 169   3      //                  if(LedOpenSet[2]<0){LedOpenSet[2]=59;}//ç§’è¶Šç•Œåˆ¤æ–­             
 170   3                      }
 171   2                      else if(TimeSetSelect>14&&TimeSetSelect<17)
 172   2                      {
 173   3                          LedCloseTime=TimeSetSelect-15;
 174   3                              LedCloseSet[LedCloseTime]--;
 175   3                              if(LedCloseSet[0]<0){LedCloseSet[0]=23;}//æ—¶è¶Šç•Œåˆ¤æ–­
 176   3                          if(LedCloseSet[1]<0){LedCloseSet[1]=59;}//åˆ†è¶Šç•Œåˆ¤æ–­
 177   3      //                  if(LedCloseSet[2]<0){LedCloseSet[2]=59;}//ç§’è¶Šç•Œåˆ¤æ–­
C51 COMPILER V9.54   MAIN                                                                  05/02/2023 15:26:32 PAGE 4   

 178   3                      }
 179   2              }
 180   1              //æ›´æ–°æ˜¾ç¤ºï¼Œæ ¹æ®TimeSetSelectå’ŒTimeSetFlashFlagåˆ¤æ–­å¯å®Œæˆé—ªçƒåŠŸèƒ½
 181   1              if(TimeSetSelect<7)
 182   1              {
 183   2                      LCD_ShowString(2,10," ReTIME");//LCDæ˜¾ç¤ºå®æ—¶æ—¶é—´ReTIMEï¼ˆReal TIMEï¼‰
 184   2              if(TimeSetSelect==0 && TimeSetFlashFlag==1){LCD_ShowString(1,1,"  ");}//é€šè¿‡è®¾ç½®ä¸­æ–­æ ‡å¿—ä½
             -ï¼Œä½¿æ ‡å¿—ä½TimeSetFlashFlagåœ¨0å’Œ1ä¹‹é—´æ¥å›åˆ‡æ¢ï¼Œä¸”åœ¨1æ—¶æ˜¾ç¤ºç©ºå­—ç¬¦ï¼Œå³å¯å®ç°é€‰ä¸­æ•°æ®é—ªçƒå
             -ŠŸèƒ½
 185   2                  else {LCD_ShowNum(1,1,DS1302_Time[0],2);}
 186   2                  if(TimeSetSelect==1 && TimeSetFlashFlag==1){LCD_ShowString(1,4,"  ");}
 187   2                  else {LCD_ShowNum(1,4,DS1302_Time[1],2);}
 188   2                  if(TimeSetSelect==2 && TimeSetFlashFlag==1){LCD_ShowString(1,7,"  ");}
 189   2              else {LCD_ShowNum(1,7,DS1302_Time[2],2);}       
 190   2              if(TimeSetSelect==3 && TimeSetFlashFlag==1){LCD_ShowString(2,1,"  ");}
 191   2              else {LCD_ShowNum(2,1,DS1302_Time[3],2);}
 192   2              if(TimeSetSelect==4 && TimeSetFlashFlag==1){LCD_ShowString(2,4,"  ");}
 193   2              else {LCD_ShowNum(2,4,DS1302_Time[4],2);}
 194   2              if(TimeSetSelect==5 && TimeSetFlashFlag==1){LCD_ShowString(2,7,"  ");LCD_ShowNum(1,16,DS1302_Time[
             -6],1);}
 195   2              else {LCD_ShowNum(2,7,DS1302_Time[5],2);}
 196   2              if(TimeSetSelect==6 && TimeSetFlashFlag==1){LCD_ShowString(1,16," ");}
 197   2              else {LCD_ShowNum(1,16,DS1302_Time[6],1);}
 198   2              }
 199   1              else if(TimeSetSelect>6&&TimeSetSelect<10)//æ—¶é’Ÿè®¾ç½®è¿‡åï¼Œåˆ‡æ¢åˆ°å–‚é£Ÿæ—¶é—´è®¾ç½®ï¼Œä¸€å¤©å–‚é
             -£Ÿä¸¤æ¬¡ï¼Œå› æ­¤æœ‰ä¸¤ä¸ªæ—¶é—´å¯ä»¥è®¾ç½®
 200   1              {
 201   2              LCD_ShowString(2,10," F1TIME");//LCDåˆ‡æ¢æ˜¾ç¤ºä¸ºç¬¬ä¸€æ¬¡å–‚é£Ÿæ—¶é—´è®¾ç½®F1TIMEï¼ˆFeed1 TIMEï
             -¼‰
 202   2              if(TimeSetSelect==7 && TimeSetFlashFlag==1){LCD_ShowString(2,1,"  ");LCD_ShowNum(1,16,DS1302_Time[
             -6],1);}
 203   2              else {LCD_ShowNum(2,1,FeedTime1[0],2);}
 204   2              if(TimeSetSelect==8 && TimeSetFlashFlag==1){LCD_ShowString(2,4,"  ");}
 205   2              else {LCD_ShowNum(2,4,FeedTime1[1],2);}
 206   2              if(TimeSetSelect==9 && TimeSetFlashFlag==1){LCD_ShowString(2,7,"  ");}
 207   2              else {LCD_ShowNum(2,7,FeedTime1[2],2);}
 208   2                      }
 209   1              else if(TimeSetSelect>9&&TimeSetSelect<13)
 210   1              {
 211   2                  LCD_ShowString(2,10," F2TIME");//LCDåˆ‡æ¢æ˜¾ç¤ºä¸ºç¬¬äºŒæ¬¡å–‚é£Ÿæ—¶é—´è®¾ç½®F2TIMEï¼ˆFeed2 TIMEï¼‰
 212   2              if(TimeSetSelect==10 && TimeSetFlashFlag==1){LCD_ShowString(2,1,"  ");}
 213   2              else {LCD_ShowNum(2,1,FeedTime2[0],2);}
 214   2              if(TimeSetSelect==11 && TimeSetFlashFlag==1){LCD_ShowString(2,4,"  ");}
 215   2              else {LCD_ShowNum(2,4,FeedTime2[1],2);}
 216   2              if(TimeSetSelect==12 && TimeSetFlashFlag==1){LCD_ShowString(2,7,"  ");}
 217   2              else {LCD_ShowNum(2,7,FeedTime2[2],2);}
 218   2              }
 219   1              else if(TimeSetSelect>12&&TimeSetSelect<15)     //å–‚é£Ÿä¹‹ååˆ‡æ¢åˆ°ledè¡¥å…‰æ—¶é—´è®¾ç½®ï¼Œå¼€å¯æ—¶é—´è®
             -¾ç½®
 220   1              {
 221   2                  LCD_ShowString(2,10," LOTIME");//LCDåˆ‡æ¢æ˜¾ç¤ºä¸ºLCTIMEï¼ˆLightLED Open Timeï¼‰
 222   2              if(TimeSetSelect==13 && TimeSetFlashFlag==1){LCD_ShowString(2,1,"  ");}
 223   2              else {LCD_ShowNum(2,1,LedOpenSet[0],2);}
 224   2              if(TimeSetSelect==14 && TimeSetFlashFlag==1){LCD_ShowString(2,4,"  ");}
 225   2              else {LCD_ShowNum(2,4,LedOpenSet[1],2);}
 226   2      //          if(TimeSetSelect==14 && TimeSetFlashFlag==1){LCD_ShowString(2,7,"  ");}
 227   2              LCD_ShowNum(2,7,LedOpenSet[2],2);
 228   2              }
 229   1              else if(TimeSetSelect>14&&TimeSetSelect<17)     //å–‚é£Ÿä¹‹ååˆ‡æ¢åˆ°ledè¡¥å…‰æ—¶é—´è®¾ç½®ï¼Œå…³é—­æ—¶é—´è®
             -¾ç½®
 230   1              {
 231   2                  LCD_ShowString(2,10," LCTIME");//LCDåˆ‡æ¢æ˜¾ç¤ºä¸ºLCTIMEï¼ˆLightLED Close Timeï¼‰
C51 COMPILER V9.54   MAIN                                                                  05/02/2023 15:26:32 PAGE 5   

 232   2              if(TimeSetSelect==15 && TimeSetFlashFlag==1){LCD_ShowString(2,1,"  ");}
 233   2              else {LCD_ShowNum(2,1,LedCloseSet[0],2);}
 234   2              if(TimeSetSelect==16 && TimeSetFlashFlag==1){LCD_ShowString(2,4,"  ");}
 235   2              else {LCD_ShowNum(2,4,LedCloseSet[1],2);}
 236   2      //              if(TimeSetSelect==17 && TimeSetFlashFlag==1){LCD_ShowString(2,7,"  ");}
 237   2              LCD_ShowNum(2,7,LedCloseSet[2],2);
 238   2              }
 239   1      }
 240          
 241          void Feed()//å¯¹æ¯”å®æ—¶æ—¶é—´å’Œé¢„è®¾å–‚é£Ÿæ—¶é—´ï¼Œè‹¥ä¸€æ ·ï¼Œä½¿æ ‡å¿—ä½FeedFlagç½®1å¹¶å¯åŠ¨ç”µæœº
 242          {
 243   1              DS1302_ReadTime1();//è°ƒç”¨è¯»å–æ—¶é—´å‡½æ•°ä»¥ç”¨äºæ¯”è¾ƒ
 244   1              if(Real_Time[0]==FeedTime1[0]&&Real_Time[1]==FeedTime1[1]&&Real_Time[2]==FeedTime1[2])//å½“ç°å®æ—¶é—´ç­
             -‰äºå–‚é£Ÿæ—¶é—´
 245   1              {         
 246   2            P2_2=0;   
 247   2            P1_3=0;
 248   2            FeedFlag=1;
 249   2              }
 250   1              if(Real_Time[0]==FeedTime2[0]&&Real_Time[1]==FeedTime2[1]&&Real_Time[2]==FeedTime2[2])//å½“ç°å®æ—¶é—´ç­
             -‰äºå–‚é£Ÿæ—¶é—´
 251   1              {
 252   2            P2_2=0;   
 253   2            P1_3=0;
 254   2            FeedFlag=1;  
 255   2              }
 256   1      }
 257          
 258          void LedOpen()//å¯¹æ¯”å®æ—¶æ—¶é—´å’Œé¢„è®¾è¡¥å…‰æ—¶é—´ï¼Œè‹¥ä¸€æ ·ï¼Œä½¿æ ‡å¿—ä½LightFlagç½®1
 259          {
 260   1              unsigned long int real,lightopen1,lightopen2;
 261   1              DS1302_ReadTime1();
 262   1              real=Real_Time[0]*60+Real_Time[1];//ä»¥åˆ†ä¸ºå•ä½ï¼Œç®—å‡ºåŒºé—´åœ¨å¤šå°‘åˆ†ä¹‹é—´ï¼Œ
 263   1              lightopen1=LedOpenSet[0]*60+LedOpenSet[1];
 264   1              lightopen2=LedCloseSet[0]*60+LedCloseSet[1];
 265   1              if(real>lightopen1 && real<lightopen2)
 266   1              {               
 267   2                      LightFlag=1;      
 268   2              }
 269   1              else
 270   1              {
 271   2                  LightFlag=0;
 272   2              }
 273   1              
 274   1      }
 275          
 276          void main()
 277          {
 278   1              P1=0xFF;                   //P1ç®¡è„šåˆå§‹åŒ–
 279   1          DS18B20_ConvertT();         //ä¸Šç”µå…ˆè½¬æ¢ä¸€æ¬¡æ¸©åº¦ï¼Œé˜²æ­¢ç¬¬ä¸€æ¬¡è¯»æ•°æ®é”™è¯¯  
 280   1          LCD_Init();
 281   1          ShowTemperature();
 282   1              DS1302_Init();
 283   1              Timer0Init();
 284   1              LCD_ShowString(1,1,"  -  -  ");//é™æ€å­—ç¬¦åˆå§‹åŒ–æ˜¾ç¤º
 285   1              LCD_ShowString(2,1,"  :  :  ");
 286   1              DS1302_SetTime();//è®¾ç½®æ—¶é—´
 287   1                  
 288   1              while(1)
 289   1              {
 290   2                      Feed();
 291   2                      LedOpen();
C51 COMPILER V9.54   MAIN                                                                  05/02/2023 15:26:32 PAGE 6   

 292   2              Check_WaterLevel();
 293   2              KeyNum=Key();//è¯»å–é”®ç 
 294   2                      if(KeyNum==1)//æŒ‰é”®1æŒ‰ä¸‹
 295   2                      {
 296   3                              if(MODE==0){MODE=1;TimeSetSelect=0;}//åŠŸèƒ½åˆ‡æ¢
 297   3                              else if(MODE==1){MODE=0;DS1302_SetTime();}
 298   3                      }
 299   2                      switch(MODE)//æ ¹æ®ä¸åŒçš„åŠŸèƒ½æ‰§è¡Œä¸åŒçš„å‡½æ•°
 300   2                      {
 301   3                              case 0:TimeShow();ShowTemperature();break;
 302   3                              case 1:TimeSet();break;
 303   3                      }
 304   2      
 305   2              }
 306   1      }
 307          
 308          void Timer0_Routine() interrupt 1
 309          {
 310   1              static unsigned int T0Count0,T0Count1,T0Count2;
 311   1              TL0 = 0x18;             //è®¾ç½®å®šæ—¶åˆå€¼
 312   1              TH0 = 0xFC;             //è®¾ç½®å®šæ—¶åˆå€¼
 313   1              
 314   1              T0Count0++;
 315   1              if(T0Count0>=500)//æ¯500msè¿›å…¥ä¸€æ¬¡
 316   1              {
 317   2                      T0Count0=0;
 318   2                      TimeSetFlashFlag=!TimeSetFlashFlag;//é—ªçƒæ ‡å¿—ä½å–å
 319   2              }
 320   1              
 321   1              T0Count1++;
 322   1              if(T0Count1>=20)//æŒ‰é”®æ‰«æ
 323   1              {
 324   2                      T0Count1=0;
 325   2                      Key_Loop();     //20msè°ƒç”¨ä¸€æ¬¡æŒ‰é”®é©±åŠ¨å‡½æ•°    
 326   2              }
 327   1              
 328   1              if(FeedFlag==1)//å–‚é£Ÿæ—¶é•¿æ§åˆ¶
 329   1              {
 330   2                  T0Count2++;
 331   2                  if(T0Count2>=2000)
 332   2                  {
 333   3                          T0Count2=0;
 334   3                          FeedFlag=0; //2sï¼ˆ200*10msï¼‰åå…³é—­å–‚é£Ÿç³»ç»Ÿ
 335   3                              P2_2=1;
 336   3                  P1_3=1;
 337   3                  }
 338   2              }
 339   1                      
 340   1          if(P1_6==1&&LightFlag==1){P2_1=0;}//å½“å…‰å¼ºè¾ƒä½ï¼ˆP1_6ä¸ºé«˜ç”µå¹³ï¼‰ï¼Œä¸”æ—¶é—´åŒºé—´æ»¡è¶³ï¼Œå
             -³æ ‡å¿—ä½LightFlagä¸º1æ—¶ï¼Œæ‰“å¼€LEdè¿›è¡Œè¡¥å…‰     
 341   1          else{P2_1=1;}       
 342   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   2533    ----
   CONSTANT SIZE    =     72    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     29      12
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
C51 COMPILER V9.54   MAIN                                                                  05/02/2023 15:26:32 PAGE 7   

END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
